<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buy YouTube Channels - ytmarket.store</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* ---- Basic Styling (already included) ---- */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f2f2f2;
    }

    .container {
      max-width: 1200px;
      margin: 60px auto;
      padding: 20px;
    }

    .category-header {
      font-size: 1.8em;
      font-weight: bold;
      margin: 40px 0 10px;
    }

    .category-divider {
      margin-top: 60px;
      border: none;
      height: 2px;
      background: linear-gradient(to right, #ccc, #999, #ccc);
    }

    .channel-card {
      background-color: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      border-radius: 10px;
      overflow: hidden;
      display: flex;
      margin-bottom: 20px;
      transition: transform 0.3s ease;
    }

    .channel-card:hover {
      transform: translateY(-5px);
    }

    .channel-image {
      width: 200px;
      height: 100%;
      object-fit: cover;
    }

    .channel-info {
      padding: 15px;
      flex: 1;
    }

    .channel-name {
      font-size: 1.4em;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .info-row {
      margin-bottom: 5px;
      color: #555;
    }

    .badge {
      display: inline-block;
      background-color: #4caf50;
      color: white;
      padding: 2px 6px;
      margin: 2px 2px 2px 0;
      border-radius: 5px;
      font-size: 0.75em;
    }

    .badge.non-monetized {
      background-color: #f44336;
    }

    .price {
      font-weight: bold;
      font-size: 1.2em;
      color: #2196f3;
      margin: 8px 0;
    }

    .buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .buy-btn,
    .details-btn {
      padding: 8px 14px;
      font-size: 0.9em;
      cursor: pointer;
      border: none;
      border-radius: 5px;
    }

    .buy-btn {
      background-color: #4caf50;
      color: white;
    }

    .buy-btn:disabled {
      background-color: #999;
      cursor: not-allowed;
    }

    .details-btn {
      background-color: #2196f3;
      color: white;
    }

    /* Popup styling */
    .popup-overlay {
      position: fixed;
      display: none;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .popup-box {
      background-color: white;
      border-radius: 10px;
      max-width: 90%;
      width: 600px;
      padding: 20px;
      position: relative;
      text-align: center;
    }

    .popup-close {
      position: absolute;
      top: 10px; right: 15px;
      background: transparent;
      border: none;
      font-size: 1.5em;
      cursor: pointer;
    }

    .popup-title {
      font-size: 1.5em;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .popup-description {
      margin: 10px 0;
      color: #444;
    }

    .popup-price {
      font-size: 1.3em;
      font-weight: bold;
      color: #4caf50;
      margin: 15px 0;
    }

    .popup-buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }

    .popup-close-btn,
    .confirm-pay-btn {
      padding: 8px 16px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .popup-close-btn {
      background-color: #999;
      color: white;
    }

    .confirm-pay-btn {
      background-color: #4caf50;
      color: white;
    }

    .slideshow {
      position: relative;
      height: 300px;
      overflow: hidden;
      margin: 10px 0;
    }

    .slide-image {
      display: none;
      width: 100%;
      height: 300px;
      object-fit: cover;
    }

    .slide-image.active {
      display: block;
    }

    .arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 2em;
      background: rgba(0,0,0,0.5);
      color: white;
      border: none;
      cursor: pointer;
      padding: 5px 10px;
    }

    .arrow.left {
      left: 0;
    }

    .arrow.right {
      right: 0;
    }

    .payment-qr img {
      width: 200px;
      margin: 20px 0;
    }

    .payment-instruction {
      color: #555;
    }
  </style>
</head>
<body>
  <div class="container" id="channelContainer">
    <!-- Cards will be injected here -->
  </div>

  <!-- More Details Popup -->
  <div class="popup-overlay" id="detailsPopup">
    <div class="popup-box">
      <button class="popup-close" aria-label="Close Details">&times;</button>
      <div class="popup-title" id="popupTitle">Channel Title</div>
      <div class="slideshow">
        <img class="slide-image active" />
        <img class="slide-image" />
        <img class="slide-image" />
        <button class="arrow left">&#10094;</button>
        <button class="arrow right">&#10095;</button>
      </div>
      <div class="popup-description">Channel Description goes here.</div>
      <div class="popup-price">₹0</div>
      <div class="popup-buttons">
        <button class="popup-close-btn">Close</button>
      </div>
    </div>
  </div>

  <!-- Payment Popup -->
  <div class="popup-overlay" id="paymentPopup" style="display:none;">
    <div class="popup-box">
      <button class="popup-close" aria-label="Close Payment">&times;</button>
      <div class="payment-qr">
        <img src="qr-code.png" alt="QR Code to Pay" />
        <div class="payment-instruction">Scan QR to Pay using any UPI App</div>
      </div>
      <div class="popup-price">₹0</div>
      <button class="confirm-pay-btn">I’ve Paid – Continue</button>
    </div>
  </div>

  <!-- JS Section -->
  <script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQKJ0UZltm-vg8usAZSYOu0cpadqHO2wHgqHgIX_7t7aAgDovAXknkRyK_NiITZ8U0JEXt-ARkLmPZC/pub?output=csv';

    fetch(SHEET_URL)
      .then(res => res.text())
      .then(text => {
        const [header, ...lines] = text.trim().split('\n').map(r => r.split(','));
        const data = lines.map(row => Object.fromEntries(header.map((h, i) => [h.trim(), row[i]?.trim() || ''])));

        const container = document.getElementById('channelContainer');
        const grouped = {};

        data.forEach(d => {
          const cat = d.Category || 'Uncategorized';
          if (!grouped[cat]) grouped[cat] = [];
          grouped[cat].push(d);
        });

        for (const cat in grouped) {
          container.innerHTML += `
            <hr class="category-divider" />
            <div class="category-header">${cat}</div>
          `;

          grouped[cat].forEach(ch => {
            const tags = (ch.Tags || '').split(',').map(t => `<span class="badge">${t.trim()}</span>`).join(' ');
            const monetizedBadge = ch.Monetization.toLowerCase() === 'monetized'
              ? `<span class="badge">Monetized</span>`
              : `<span class="badge non-monetized">Non-Monetized</span>`;
            const sold = ch.Status.toLowerCase() === 'sold';

            const card = document.createElement('div');
            card.className = 'channel-card';
            card.innerHTML = `
              <img class="channel-image" src="${ch.Image1}" loading="lazy" />
              <div class="channel-info">
                <div class="channel-name">${ch.Name}</div>
                <div class="info-row">${ch.Subscribers} Subs | ${ch.LifetimeViews} Views</div>
                <div class="info-row">${monetizedBadge} ${tags}</div>
                <div class="price">₹${ch.Price}</div>
                <div class="buttons">
                  <button class="buy-btn" ${sold ? 'disabled' : ''}>${sold ? 'Sold' : 'Buy'}</button>
                  <button class="details-btn">More Details</button>
                </div>
              </div>
            `;
            const [buyBtn, detailBtn] = card.querySelectorAll('button');
            buyBtn.onclick = () => showPaymentPopup(ch);
            detailBtn.onclick = () => showDetailsPopup(ch);
            container.appendChild(card);
          });
        }
      });

    // Popup functions
    let currentSlide = 0;
    function showDetailsPopup(ch) {
      document.getElementById('detailsPopup').style.display = 'flex';
      const popup = document.getElementById('detailsPopup');
      popup.querySelector('#popupTitle').textContent = ch.Name;
      popup.querySelector('.popup-description').textContent = ch.Description;
      popup.querySelector('.popup-price').textContent = '₹' + ch.Price;

      const images = [ch.Image1, ch.Image2, ch.Image3].filter(Boolean);
      const imgElems = popup.querySelectorAll('.slide-image');
      imgElems.forEach((img, i) => {
        img.src = images[i] || '';
        img.classList.toggle('active', i === 0);
      });
      currentSlide = 0;
    }

    function navigateSlide(dir) {
      const imgs = document.querySelectorAll('#detailsPopup .slide-image');
      imgs[currentSlide].classList.remove('active');
      currentSlide = (currentSlide + dir + imgs.length) % imgs.length;
      imgs[currentSlide].classList.add('active');
    }

    document.querySelector('#detailsPopup .arrow.left').onclick = () => navigateSlide(-1);
    document.querySelector('#detailsPopup .arrow.right').onclick = () => navigateSlide(1);
    document.querySelectorAll('.popup-close, .popup-close-btn').forEach(btn =>
      btn.onclick = () => {
        document.getElementById('detailsPopup').style.display = 'none';
        document.getElementById('paymentPopup').style.display = 'none';
      }
    );

    function showPaymentPopup(ch) {
      const pay = document.getElementById('paymentPopup');
      pay.style.display = 'flex';
      pay.querySelector('.popup-price').textContent = '₹' + ch.Price;
      pay.querySelector('.confirm-pay-btn').onclick = () => {
        setTimeout(() => {
          window.location.href = 'delivery.html?channel=' + encodeURIComponent(ch.Name);
        }, 500);
      };
    }
  </script>
</body>
</html>
